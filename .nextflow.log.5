Oct-22 10:41:39.952 [main] DEBUG nextflow.cli.Launcher - $> nextflow run main.nf
Oct-22 10:41:40.001 [main] DEBUG nextflow.cli.CmdRun - N E X T F L O W  ~  version 24.04.4
Oct-22 10:41:40.027 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; embedded=false; plugins-dir=/Users/winniecook/.nextflow/plugins; core-plugins: nf-amazon@2.5.3,nf-azure@1.6.1,nf-cloudcache@0.4.1,nf-codecommit@0.2.1,nf-console@1.1.3,nf-ga4gh@1.3.0,nf-google@1.13.2-patch1,nf-tower@1.9.1,nf-wave@1.4.2-patch1
Oct-22 10:41:40.034 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
Oct-22 10:41:40.034 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
Oct-22 10:41:40.036 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.12.0 in 'deployment' mode
Oct-22 10:41:40.044 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
Oct-22 10:41:42.321 [main] DEBUG nextflow.cli.CmdRun - Applied DSL=2 by global default
Oct-22 10:41:42.343 [main] DEBUG nextflow.cli.CmdRun - Launching `main.nf` [pedantic_torvalds] DSL2 - revision: 983603582e
Oct-22 10:41:42.345 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[]
Oct-22 10:41:42.345 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins resolved requirement=[]
Oct-22 10:41:42.405 [main] DEBUG nextflow.Session - Session UUID: 26bfed04-8a69-4f0a-b847-3078146792ba
Oct-22 10:41:42.405 [main] DEBUG nextflow.Session - Run name: pedantic_torvalds
Oct-22 10:41:42.406 [main] DEBUG nextflow.Session - Executor pool size: 8
Oct-22 10:41:42.412 [main] DEBUG nextflow.file.FilePorter - File porter settings maxRetries=3; maxTransfers=50; pollTimeout=null
Oct-22 10:41:42.415 [main] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'FileTransfer' minSize=10; maxSize=24; workQueue=LinkedBlockingQueue[10000]; allowCoreThreadTimeout=false
Oct-22 10:41:42.430 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 24.04.4 build 5917
  Created: 01-08-2024 07:05 UTC (08:05 BST)
  System: Mac OS X 15.0.1
  Runtime: Groovy 4.0.21 on OpenJDK 64-Bit Server VM 17.0.13+0
  Encoding: UTF-8 (UTF-8)
  Process: 4151@Winnies-MacBook-Air.local [127.0.0.1]
  CPUs: 8 - Mem: 8 GB (110.3 MB) - Swap: 0 (0)
Oct-22 10:41:42.440 [main] DEBUG nextflow.Session - Work-dir: /Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/work [Mac OS X]
Oct-22 10:41:42.441 [main] DEBUG nextflow.Session - Script base path does not exist or is not a directory: /Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/bin
Oct-22 10:41:42.452 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[]
Oct-22 10:41:42.458 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
Oct-22 10:41:42.474 [main] DEBUG nextflow.cache.CacheFactory - Using Nextflow cache factory: nextflow.cache.DefaultCacheFactory
Oct-22 10:41:42.480 [main] DEBUG nextflow.util.CustomThreadPool - Creating default thread pool > poolSize: 9; maxThreads: 1000
Oct-22 10:41:42.512 [main] DEBUG nextflow.Session - Session start
Oct-22 10:41:42.928 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Oct-22 10:41:42.934 [main] DEBUG n.secret.LocalSecretsProvider - Secrets store: /Users/winniecook/.nextflow/secrets/store.json
Oct-22 10:41:42.939 [main] DEBUG nextflow.secret.SecretsLoader - Discovered secrets providers: [nextflow.secret.LocalSecretsProvider@1ca610a0] - activable => nextflow.secret.LocalSecretsProvider@1ca610a0
Oct-22 10:41:43.010 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-22 10:41:43.010 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-22 10:41:43.013 [main] DEBUG nextflow.executor.Executor - [warm up] executor > local
Oct-22 10:41:43.017 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=8; memory=8 GB; capacity=8; pollInterval=100ms; dumpInterval=5m
Oct-22 10:41:43.018 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: local)
Oct-22 10:41:43.066 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-22 10:41:43.066 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-22 10:41:43.068 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-22 10:41:43.069 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-22 10:41:43.072 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: null
Oct-22 10:41:43.072 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Oct-22 10:41:43.074 [main] DEBUG nextflow.Session - Workflow process names [dsl2]: VISUALIZATION, PREPROCESS, STATISTICAL_MODELING, EXPLORATORY_ANALYSIS
Oct-22 10:41:43.074 [main] DEBUG nextflow.Session - Igniting dataflow network (5)
Oct-22 10:41:43.078 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > PREPROCESS
Oct-22 10:41:43.078 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > EXPLORATORY_ANALYSIS
Oct-22 10:41:43.078 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > STATISTICAL_MODELING
Oct-22 10:41:43.079 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > VISUALIZATION
Oct-22 10:41:43.079 [main] DEBUG nextflow.script.ScriptRunner - Parsed script files:
  Script_858d5d6d6c212901: /Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/main.nf
Oct-22 10:41:43.079 [main] DEBUG nextflow.script.ScriptRunner - > Awaiting termination 
Oct-22 10:41:43.079 [main] DEBUG nextflow.Session - Session await
Oct-22 10:41:43.182 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Oct-22 10:41:43.184 [Task submitter] INFO  nextflow.Session - [75/945c0d] Submitted process > PREPROCESS (1)
Oct-22 10:41:50.346 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 1; name: PREPROCESS (1); status: COMPLETED; exit: 1; error: -; workDir: /Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/work/75/945c0dc72cce8ee69609e3ac823019]
Oct-22 10:41:50.347 [Task monitor] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'TaskFinalizer' minSize=10; maxSize=24; workQueue=LinkedBlockingQueue[10000]; allowCoreThreadTimeout=false
Oct-22 10:41:50.350 [TaskFinalizer-1] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=PREPROCESS (1); work-dir=/Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/work/75/945c0dc72cce8ee69609e3ac823019
  error [nextflow.exception.ProcessFailedException]: Process `PREPROCESS (1)` terminated with an error exit status (1)
Oct-22 10:41:50.362 [TaskFinalizer-1] ERROR nextflow.processor.TaskProcessor - Error executing process > 'PREPROCESS (1)'

Caused by:
  Process `PREPROCESS (1)` terminated with an error exit status (1)


Command executed:

  python /Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/scripts/01_data_preprocessing.py forests.csv preprocessed_data.csv

Command exit status:
  1

Command output:
  (empty)

Command error:
  Traceback (most recent call last):
    File "/Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/scripts/01_data_preprocessing.py", line 53, in <module>
      main(input_file, output_file)
    File "/Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/scripts/01_data_preprocessing.py", line 45, in main
      df = normalize_features(df)
           ^^^^^^^^^^^^^^^^^^^^^^
    File "/Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/scripts/01_data_preprocessing.py", line 31, in normalize_features
      df[numeric_features] = scaler.fit_transform(df[numeric_features])
                                                  ~~^^^^^^^^^^^^^^^^^^
    File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/frame.py", line 4108, in __getitem__
      indexer = self.columns._get_indexer_strict(key, "columns")[1]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
      self._raise_if_missing(keyarr, indexer, axis_name)
    File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
      raise KeyError(f"{not_found} not in index")
  KeyError: "['DMC', 'DC'] not in index"

Work dir:
  /Users/winniecook/Documents/Updating_Projects/Script_Projects/forest-fire-analysis/work/75/945c0dc72cce8ee69609e3ac823019

Tip: when you have fixed the problem you can continue the execution adding the option `-resume` to the run command line
Oct-22 10:41:50.367 [main] DEBUG nextflow.Session - Session await > all processes finished
Oct-22 10:41:50.368 [TaskFinalizer-1] DEBUG nextflow.Session - Session aborted -- Cause: Process `PREPROCESS (1)` terminated with an error exit status (1)
Oct-22 10:41:50.380 [main] DEBUG nextflow.Session - Session await > all barriers passed
Oct-22 10:41:50.381 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: local) - terminating tasks monitor poll loop
Oct-22 10:41:50.386 [main] DEBUG n.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=0; failedCount=1; ignoredCount=0; cachedCount=0; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=0; abortedCount=0; succeedDuration=0ms; failedDuration=7.1s; cachedDuration=0ms;loadCpus=0; loadMemory=0; peakRunning=1; peakCpus=1; peakMemory=0; ]
Oct-22 10:41:50.587 [main] DEBUG nextflow.cache.CacheDB - Closing CacheDB done
Oct-22 10:41:50.596 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
